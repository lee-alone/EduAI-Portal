<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>课堂互动平台</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css"> <!-- Module-specific styles -->
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- XLSX for Excel export -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <!-- FileSaver for file downloads -->
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- html2canvas for HTML to PDF conversion -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <nav class="header-nav">
        <div class="container">
            <h1>课堂互动平台</h1>
            <div class="header-controls">
                <!-- 布局控制按钮 -->
                <div class="layout-controls-header">
                    <div class="layout-indicator-header">
                        <i class="fas fa-desktop"></i>
                        <span id="layout-mode-text-header">自动检测</span>
                    </div>
                    <button id="layout-toggle-btn-header" class="header-btn">
                        <i class="fas fa-exchange-alt"></i>
                        <span>切换布局</span>
                    </button>
                    <button id="fullscreen-toggle-btn-header" class="header-btn">
                        <i class="fas fa-expand"></i>
                        <span>全屏模式</span>
                    </button>
                </div>
                <a href="../../index.html" class="back-home-btn">
                    <i class="fas fa-home mr-2"></i>
                    返回首页
                </a>
            </div>
        </div>
    </nav>

    <main class="main-content">
            <div class="tabs-container">
                <button class="tab-button active" data-tab="live-interaction">实时互动</button>
                <button class="tab-button" data-tab="ai-analysis">AI学情分析</button>
            </div>

            <div id="live-interaction" class="tab-content active">
                <div class="mb-4">
                    <h2 class="text-xl font-semibold text-gray-800">实时课堂互动</h2>
                </div>
                <div id="layout-switch-notification" class="notification hidden mb-4">
                    <div class="notification-content">
                        <i class="fas fa-info-circle mr-2"></i>
                        <span id="notification-text">布局已切换</span>
                    </div>
                </div>
                <div id="module-container" class="grid gap-6 equal-height-grid">
                    <!-- 点名系统 -->
                    <div class="module-section">
                        <h3 class="text-lg font-semibold mb-3 text-gray-700"><i class="fas fa-user-check mr-2"></i>点名系统</h3>
                        <div class="form-group">
                            <label for="subject-input" class="block text-gray-700 text-sm font-bold mb-2">学科: <span class="text-red-500">*</span></label>
                            <div class="flex gap-2">
                                <select id="subject-select" class="modern-input flex-1">
                                    <option value="">请选择学科</option>
                                    <option value="数学">数学</option>
                                    <option value="语文">语文</option>
                                    <option value="英语">英语</option>
                                    <option value="物理">物理</option>
                                    <option value="化学">化学</option>
                                    <option value="生物">生物</option>
                                    <option value="历史">历史</option>
                                    <option value="地理">地理</option>
                                    <option value="政治">政治</option>
                                    <option value="体育">体育</option>
                                    <option value="美术">美术</option>
                                    <option value="音乐">音乐</option>
                                    <option value="信息技术">信息技术</option>
                                    <option value="班会">班会</option>
                                    <option value="其他">其他</option>
                                </select>
                                <button type="button" id="subject-custom-btn" class="btn btn-outline px-3">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </div>
                            <input type="text" id="subject-input" class="modern-input mt-2" placeholder="或直接输入学科名称" style="display: none;">
                        </div>
                        
                        <div class="form-group">
                            <label class="block text-gray-700 text-sm font-bold mb-2">日期:</label>
                            <span id="date-display" class="block text-gray-800 text-lg font-medium"></span>
                        </div>

                        <div class="card-section">
                            <h4 class="font-medium mb-2 text-gray-700">点名</h4>
                            <div class="grid grid-cols-2 gap-2">
                                <button id="random-call-btn" class="btn btn-primary w-full"><i class="fas fa-user mr-2"></i>随机一人</button>
                                <button id="multi-call-btn" class="btn btn-warning w-full"><i class="fas fa-users mr-2"></i>多人点名</button>
                            </div>
                            <div class="form-group mt-2">
                                <label for="multi-call-num" class="block text-gray-700 text-sm font-bold mb-2">多人点名人数:</label>
                                <input type="number" id="multi-call-num" class="modern-input" value="3" min="1">
                            </div>
                        </div>

                        <div class="card-section">
                            <h4 class="font-medium mb-2 text-gray-700">
                                <i class="fas fa-user-check mr-2 text-blue-600"></i>已点名学生
                            </h4>
                            <div id="called-students-list" class="min-h-[80px]">
                                <!-- 已点名学生列表 -->
                            </div>
                            <button id="reset-call-btn" class="btn btn-danger w-full mt-3">
                                <i class="fas fa-undo mr-2"></i>重置点名
                            </button>
                        </div>

                        <!-- 快速评分区域 -->
                        <div class="card-section quick-scoring-card" id="quick-scoring-section" style="display: none;">
                            <h4 class="font-medium mb-2 text-gray-700"><i class="fas fa-star mr-2"></i>快速评分</h4>
                            <div id="current-student-info" class="student-info-card">
                                <div class="text-center">
                                    <div class="text-lg font-semibold" id="current-student-name">学生姓名</div>
                                    <div class="text-sm opacity-90" id="current-student-id">座号</div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="block text-gray-700 text-sm font-bold mb-2">答题表现:</label>
                                <div class="quick-scoring-buttons">
                                    <button id="correct-answer-btn" class="btn btn-success performance-btn">
                                        <i class="fas fa-check mr-2"></i>回答正确
                                    </button>
                                    <button id="incorrect-answer-btn" class="btn btn-danger performance-btn">
                                        <i class="fas fa-times mr-2"></i>回答错误
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="quick-points" class="block text-gray-700 text-sm font-bold mb-2">加分值:</label>
                                <select id="quick-points" class="quick-points-select">
                                    <option value="1">1分 (优秀)</option>
                                    <option value="0.5" selected>0.5分 (良好)</option>
                                    <option value="0">0分 (错误)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="quick-reason" class="block text-gray-700 text-sm font-bold mb-2">评分原因:</label>
                                <input type="text" id="quick-reason" class="quick-reason-input" placeholder="例如：回答正确，思路清晰">
                            </div>
                            <div class="flex gap-2">
                                <button id="confirm-scoring-btn" class="btn btn-primary flex-1">
                                    <i class="fas fa-award mr-2"></i>确认评分
                                </button>
                                <button id="skip-scoring-btn" class="btn btn-secondary">
                                    <i class="fas fa-forward mr-2"></i>跳过
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 加分系统 -->
                    <div class="module-section">
                        <h3 class="text-lg font-semibold mb-3 text-gray-700"><i class="fas fa-plus-circle mr-2"></i>加分系统</h3>
                        
                        <!-- 第一步和第二步并排布局 -->
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <!-- 第一步：选择方式 -->
                            <div class="card-section">
                                <h4 class="font-medium mb-2 text-gray-700">第一步：选择方式</h4>
                                <div class="form-group">
                                    <label class="block text-gray-700 text-sm font-bold mb-2">选择方式:</label>
                                    <div class="flex gap-2 mb-3">
                                        <button id="manual-selection-btn" class="btn btn-outline btn-sm flex-1 selection-mode-btn active">
                                            <i class="fas fa-hand-pointer mr-1"></i>手动选择
                                        </button>
                                        <button id="range-selection-btn" class="btn btn-outline btn-sm flex-1 selection-mode-btn">
                                            <i class="fas fa-arrows-alt-h mr-1"></i>范围选择
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 第二步：加分类型 -->
                            <div class="card-section" id="scoring-type-section">
                                <h4 class="font-medium mb-2 text-gray-700">第二步：选择加分类型</h4>
                                <div class="form-group">
                                    <label class="block text-gray-700 text-sm font-bold mb-2">加分类型:</label>
                                    <div class="flex gap-2 mb-3">
                                        <button id="individual-scoring-btn" class="btn btn-success btn-sm flex-1">
                                            <i class="fas fa-user mr-1"></i>个人加分
                                        </button>
                                        <button id="group-scoring-btn" class="btn btn-warning btn-sm flex-1">
                                            <i class="fas fa-users mr-1"></i>集体加分
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 操作提示 -->
                        <div class="flex justify-center mt-4">
                            <div class="bg-blue-50 border-l-4 border-blue-400 p-3 w-full max-w-4xl">
                                <div class="flex items-center justify-center">
                                    <div class="flex-shrink-0 mr-2">
                                        <i class="fas fa-info-circle text-blue-500 text-sm"></i>
                                    </div>
                                    <p class="text-sm text-blue-700 text-center">
                                        <strong>操作提示：</strong>个人加分针对个人学习行为，集体加分针对集体活动行为，均支持批量操作。
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- 第一步详细内容 -->
                        <div class="card-section">
                            <!-- 手动选择方式 -->
                            <div id="manual-selection-mode" class="selection-mode">
                                <div class="form-group">
                                    <span class="block text-gray-700 text-sm font-bold mb-2">选择学生座号:</span>
                                    <div id="group-student-selection" class="student-seat-grid mb-3 max-h-96 overflow-y-auto">
                                        <!-- 学生座号复选框将在这里生成 -->
                                    </div>
                                </div>
                            </div>

                            <!-- 范围选择方式 -->
                            <div id="range-selection-mode" class="selection-mode" style="display: none;">
                                <div class="form-group">
                                    <label class="block text-gray-700 text-sm font-bold mb-2">选择范围:</label>
                                    <div class="flex gap-4 items-center">
                                        <div class="flex-1">
                                            <label for="range-start" class="block text-sm text-gray-600 mb-1">起始座号:</label>
                                            <input type="number" id="range-start" class="modern-input" min="1" max="55" placeholder="1">
                                        </div>
                                        <div class="flex-1">
                                            <label for="range-end" class="block text-sm text-gray-600 mb-1">结束座号:</label>
                                            <input type="number" id="range-end" class="modern-input" min="1" max="55" placeholder="10">
                                        </div>
                                        <div class="flex-1">
                                            <label for="range-step" class="block text-sm text-gray-600 mb-1">间隔:</label>
                                            <select id="range-step" class="modern-input">
                                                <option value="1">连续</option>
                                                <option value="2">隔一个</option>
                                                <option value="3">隔两个</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-2">
                                        <button id="preview-range-btn" class="btn btn-info w-full">
                                            <i class="fas fa-eye mr-2"></i>预览选择结果
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- 选择结果显示 -->
                            <div id="selection-result" class="form-group" style="display: none;">
                                <label class="block text-gray-700 text-sm font-bold mb-2">已选择学生:</label>
                                <div id="selected-students-display" class="p-3 bg-blue-50 rounded-lg border border-blue-200 min-h-[60px]">
                                    <!-- 选中的学生将显示在这里 -->
                                </div>
                                <div class="mt-2 flex gap-2">
                                    <button id="clear-selection-btn" class="btn btn-danger">
                                        <i class="fas fa-trash mr-2"></i>清空选择
                                    </button>
                                    <button id="select-all-btn" class="btn btn-info">
                                        <i class="fas fa-check-double mr-2"></i>全选
                                    </button>
                                </div>
                            </div>
                        </div>


                        <!-- 小组快速评分区域 -->
                        <div class="card-section quick-scoring-card" id="group-quick-scoring-section" style="display: none;">
                            <h4 class="font-medium mb-2 text-gray-700"><i class="fas fa-users mr-2"></i>小组快速评分</h4>
                            <div id="current-group-info" class="group-info-card">
                                <div class="text-center">
                                    <div class="text-lg font-semibold" id="current-group-students">小组学生</div>
                                    <div class="text-sm opacity-90" id="current-group-count">人数</div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="block text-gray-700 text-sm font-bold mb-2">小组表现:</label>
                                <div class="quick-scoring-buttons">
                                    <button id="group-correct-btn" class="btn btn-success performance-btn">
                                        <i class="fas fa-check mr-2"></i>表现优秀
                                    </button>
                                    <button id="group-partial-btn" class="btn btn-warning performance-btn">
                                        <i class="fas fa-minus mr-2"></i>表现一般
                                    </button>
                                    <button id="group-poor-btn" class="btn btn-danger performance-btn">
                                        <i class="fas fa-times mr-2"></i>表现不佳
                                    </button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="group-quick-points" class="block text-gray-700 text-sm font-bold mb-2">加分值:</label>
                                <select id="group-quick-points" class="quick-points-select">
                                    <option value="1">1分 (优秀)</option>
                                    <option value="0.5" selected>0.5分 (良好)</option>
                                    <option value="0">0分 (不佳)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="group-quick-reason" class="block text-gray-700 text-sm font-bold mb-2">评分原因:</label>
                                <input type="text" id="group-quick-reason" class="quick-reason-input" placeholder="例如：小组讨论积极，答案正确">
                            </div>
                            <div class="flex gap-2">
                                <button id="confirm-group-scoring-btn" class="btn btn-primary flex-1">
                                    <i class="fas fa-award mr-2"></i>确认评分
                                </button>
                                <button id="skip-group-scoring-btn" class="btn btn-secondary">
                                    <i class="fas fa-forward mr-2"></i>跳过
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 积分榜 -->
                    <div class="module-section">
                        <h3 class="text-lg font-semibold mb-3 text-gray-700"><i class="fas fa-trophy mr-2"></i>积分榜</h3>
                        <div class="card-section">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-medium text-gray-700"><i class="fas fa-star mr-1"></i>总积分榜</h4>
                                <div class="text-sm text-gray-500 leaderboard-stats" id="leaderboard-stats">
                                    <!-- 统计信息将显示在这里 -->
                                </div>
                            </div>
                            <ul id="top-students-list" class="list-none text-gray-700 min-h-[100px]">
                                <!-- 今日之星列表 -->
                            </ul>
                        </div>

                        <div class="card-section">
                            <h4 class="font-medium mb-2 text-gray-700">学科积分分布</h4>
                            <div class="chart-container">
                                <canvas id="points-distribution-chart" width="400" height="200"></canvas>
                            </div>
                            <div id="chart-no-data" class="w-full h-48 bg-gray-50 border rounded flex items-center justify-center text-gray-500" style="display: none;">
                                <i class="fas fa-chart-bar mr-2"></i>暂无积分数据
                            </div>
                        </div>

                        <div class="card-section">
                            <div class="flex items-center justify-between cursor-pointer" id="recent-log-toggle-header" onclick="toggleRecentLog()">
                                <h4 class="font-medium text-gray-700"><i class="fas fa-history mr-2"></i>最近加分记录</h4>
                                <i class="fas fa-chevron-down text-gray-500 transition-transform duration-200" id="recent-log-chevron"></i>
                            </div>
                            
                            <!-- 折叠内容区域 -->
                            <div id="recent-log-content" class="mt-4" style="display: none;">
                                <ul id="recent-points-log" class="list-none text-gray-700 min-h-[120px] overflow-y-auto border p-2 rounded bg-gray-50">
                                    <!-- 最近加分记录将显示在这里 -->
                                </ul>
                            </div>
                        </div>
                        <!-- 导出功能区域 - 折叠式设计 -->
                        <div class="card-section">
                            <div class="flex items-center justify-between cursor-pointer" id="export-toggle-header" onclick="toggleExport()">
                                <h4 class="font-medium text-gray-700"><i class="fas fa-download mr-2"></i>数据导出</h4>
                                <i class="fas fa-chevron-down text-gray-500 transition-transform duration-200" id="export-chevron"></i>
                            </div>
                            
                            <!-- 折叠内容区域 -->
                            <div id="export-content" class="mt-4" style="display: none;">
                                <!-- 时间范围选择 -->
                                <div class="form-group">
                                    <label class="block text-gray-700 text-sm font-bold mb-2">导出时间范围:</label>
                                    <div class="grid grid-cols-2 gap-2 mb-3">
                                        <button id="export-today-btn" class="btn btn-outline export-time-btn active">
                                            <i class="fas fa-calendar-day mr-2"></i>今天
                                        </button>
                                        <button id="export-week-btn" class="btn btn-outline export-time-btn">
                                            <i class="fas fa-calendar-week mr-2"></i>本周
                                        </button>
                                        <button id="export-month-btn" class="btn btn-outline export-time-btn">
                                            <i class="fas fa-calendar mr-2"></i>本月
                                        </button>
                                        <button id="export-custom-btn" class="btn btn-outline export-time-btn">
                                            <i class="fas fa-calendar-alt mr-2"></i>自定义
                                        </button>
                                    </div>
                                </div>

                                <!-- 自定义时间范围 -->
                                <div id="custom-date-range" class="form-group" style="display: none;">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label for="export-start-date" class="block text-gray-700 text-sm font-bold mb-2">开始日期:</label>
                                            <input type="date" id="export-start-date" class="modern-input">
                                        </div>
                                        <div>
                                            <label for="export-end-date" class="block text-gray-700 text-sm font-bold mb-2">结束日期:</label>
                                            <input type="date" id="export-end-date" class="modern-input">
                                        </div>
                                    </div>
                                </div>

                                <!-- 导出说明 -->
                                <div class="form-group">
                                    <div class="bg-blue-50 border-l-4 border-blue-400 p-3">
                                        <div class="flex">
                                            <div class="flex-shrink-0">
                                                <i class="fas fa-info-circle text-blue-400"></i>
                                            </div>
                                            <div class="ml-3">
                                                <p class="text-sm text-blue-700">
                                                    <strong>导出说明：</strong>将生成包含7个工作表的Excel文件，包括课堂表现记录、学生积分汇总、统计信息、学科表现分析、学生表现趋势、时间段表现分析和学科优势分析。
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- 高级设置 - 折叠式设计 -->
                                <div class="form-group border-t pt-4 mt-4">
                                    <div class="flex items-center justify-between cursor-pointer" id="advanced-settings-toggle-header" onclick="toggleAdvancedSettings()">
                                        <label class="block text-gray-700 text-sm font-bold">
                                            <i class="fas fa-cog mr-2"></i>高级设置
                                        </label>
                                        <i class="fas fa-chevron-down text-gray-500 transition-transform duration-200" id="advanced-settings-chevron"></i>
                                    </div>
                                    
                                    <!-- 折叠内容区域 -->
                                    <div id="advanced-settings-content" class="mt-4" style="display: none;">
                                        <!-- 班级人数设置 -->
                                        <div class="form-group">
                                            <label for="class-size-input" class="block text-gray-700 text-sm font-bold mb-2">班级人数:</label>
                                            <div class="flex gap-2 items-center">
                                                <input type="number" id="class-size-input" class="modern-input flex-1" value="55" min="1" max="100">
                                                <button type="button" id="apply-class-size-btn" class="btn btn-primary">
                                                    <i class="fas fa-save mr-2"></i>应用设置
                                                </button>
                                            </div>
                                            <div class="text-xs text-gray-500 mt-1">
                                                设置班级总人数，影响学生座号范围和统计计算
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <button id="export-data-btn" class="btn btn-primary w-full mt-4">
                                    <i class="fas fa-file-export mr-2"></i>导出课堂数据
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="ai-analysis" class="tab-content ai-analysis-container">
                <div class="ai-analysis-title">
                    <h2><i class="fas fa-brain mr-3"></i>AI学情分析与报告</h2>
                    <p class="ai-analysis-subtitle">智能分析学生表现，生成个性化学情报告</p>
                </div>
                
                <div class="ai-analysis-card ai-fade-in">
                    <!-- 文件上传区域 -->
                    <div class="ai-upload-section">
                        <h3 class="ai-upload-title">
                            <i class="fas fa-upload"></i>
                            数据上传
                        </h3>
                        
                        <!-- 水平并列的文件上传区域 -->
                        <div class="ai-upload-grid">
                            <div class="ai-file-upload ai-file-upload-compact">
                                <input type="file" id="activity-excel-upload" accept=".xlsx,.xls" />
                                <label for="activity-excel-upload" class="ai-file-upload-label">
                                    <div class="ai-file-upload-content">
                                        <i class="fas fa-file-excel ai-file-upload-icon"></i>
                                        <div class="ai-file-upload-text">课堂活动Excel文件</div>
                                        <div class="ai-file-upload-hint">支持 .xlsx 和 .xls 格式</div>
                                    </div>
                                </label>
                            </div>
                            
                            <div class="ai-file-upload ai-file-upload-compact">
                                <input type="file" id="roster-excel-upload" accept=".xlsx,.xls" />
                                <label for="roster-excel-upload" class="ai-file-upload-label">
                                    <div class="ai-file-upload-content">
                                        <i class="fas fa-users ai-file-upload-icon"></i>
                                        <div class="ai-file-upload-text">学生名单Excel</div>
                                        <div class="ai-file-upload-hint">座号-姓名对照</div>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- AI高级设置 - 折叠式设计 -->
                    <div class="ai-advanced-settings">
                        <div class="flex items-center justify-between cursor-pointer" id="ai-advanced-settings-toggle-header" onclick="toggleAIAdvancedSettings()">
                            <label class="block text-gray-700 text-lg font-bold">
                                <i class="fas fa-cog mr-2"></i>AI高级设置
                            </label>
                            <i class="fas fa-chevron-down text-gray-500 transition-transform duration-200" id="ai-advanced-settings-chevron"></i>
                        </div>
                        
                        <!-- 折叠内容区域 -->
                        <div id="ai-advanced-settings-content" class="mt-4" style="display: none;">
                            <!-- AI模型配置 -->
                            <div class="ai-model-section">
                                <h3 class="ai-model-title">
                                    <i class="fas fa-robot"></i>
                                    AI模型配置
                                </h3>
                                <div class="ai-model-selection">
                                    <label for="ai-model-select" class="ai-model-label">选择AI模型:</label>
                                    <select id="ai-model-select" class="ai-model-select">
                                        <option value="deepseek-chat" selected>DeepSeek 教育模型</option>
                                        <option value="glm-4">智谱 GLM 教育版</option>
                                        <option value="qwen-turbo">通义千问 教研助手</option>
                                        <option value="custom">自定义模型</option>
                                    </select>
                                </div>
                                <div class="ai-model-custom">
                                    <label for="ai-model-custom-input" class="ai-model-custom-label">自定义模型 (可选):</label>
                                    <input type="text" id="ai-model-custom-input" class="ai-model-custom-input" 
                                           placeholder="输入自定义模型名称">
                                </div>
                                <div class="ai-model-hint">
                                    选择适合的AI模型可以获得更好的分析效果。DeepSeek适合教育场景，GLM-4适合中文理解，通义千问适合教研分析。
                                </div>
                            </div>
                            
                            <!-- API配置 -->
                            <div class="ai-api-section">
                                <h3 class="ai-api-title">
                                    <i class="fas fa-key"></i>
                                    API配置
                                </h3>
                                <div class="ai-api-key-group">
                                    <label for="ai-api-key" class="ai-api-label">API Key（可选）:</label>
                                    <input type="password" id="ai-api-key" class="ai-api-key-input" 
                                           placeholder="如有专属 API Key，请在此输入">
                                    <div class="ai-api-hint">
                                        <i class="fas fa-info-circle"></i>
                                        留空将使用默认API Key，输入自定义Key将覆盖默认设置
                                    </div>
                                </div>
                                <div class="ai-endpoint-group">
                                    <label for="ai-endpoint-select" class="ai-endpoint-label">API端点:</label>
                                    <select id="ai-endpoint-select" class="ai-endpoint-select">
                                        <option value="auto" selected>自动匹配模型</option>
                                        <option value="https://api.deepseek.com/v1/chat/completions">DeepSeek API</option>
                                        <option value="https://open.bigmodel.cn/api/paas/v4/chat/completions">智谱AI API</option>
                                        <option value="https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation">通义千问 API</option>
                                        <option value="custom">自定义端点</option>
                                    </select>
                                    <div class="ai-endpoint-custom">
                                        <label for="ai-endpoint-custom-input" class="ai-endpoint-custom-label">自定义端点:</label>
                                        <input type="url" id="ai-endpoint-custom-input" class="ai-endpoint-custom-input" 
                                               placeholder="https://api.example.com/v1/chat/completions">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 自定义提示词 -->
                            <div class="ai-prompt-section">
                                <h3 class="ai-prompt-title">
                                    <i class="fas fa-edit"></i>
                                    自定义AI提示词
                                </h3>
                                <textarea id="custom-prompt-textarea" class="ai-prompt-textarea" 
                                          placeholder="例如：请以班主任的口吻，对学生的课堂表现进行总结和鼓励。分析学生的学习状态，提供个性化的建议和鼓励。"></textarea>
                                <div class="ai-prompt-hint">
                                    <i class="fas fa-lightbulb"></i>
                                    提示：详细的提示词能帮助AI生成更准确的学情分析报告
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 生成按钮 -->
                    <button id="generate-ai-report-btn" class="ai-generate-btn">
                        <i class="fas fa-robot mr-2"></i>
                        生成AI学情报告
                    </button>
                    
                    <!-- AI报告输出 -->
                    <div id="ai-report-output" class="ai-report-output">
                        <div class="ai-report-content">
                            <div style="text-align: center; color: #718096;">
                                <i class="fas fa-chart-line" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;"></i>
                                <p style="font-size: 1.1rem; margin-bottom: 0.5rem;">AI学情分析报告</p>
                                <p>上传数据文件并点击生成按钮，AI将为您生成详细的学情分析报告</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </main>

    <!-- 点名结果模态框 -->
    <div id="naming-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-user-check mr-2"></i>
                    点名结果
                </h3>
                <button class="modal-close-btn" id="close-naming-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="modal-naming-result" class="naming-result-display">
                    <!-- 点名结果将显示在这里 -->
                </div>
                <div class="modal-actions">
                    <button id="modal-quick-scoring-btn" class="btn btn-primary">
                        <i class="fas fa-edit mr-2"></i>
                        选择加分
                    </button>
                    <button id="modal-close-btn" class="btn btn-secondary">
                        <i class="fas fa-check mr-2"></i>
                        确定
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 多人点名结果模态框 -->
    <div id="multi-call-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-users mr-2"></i>
                    多人点名结果
                </h3>
                <button class="modal-close-btn" id="close-multi-call-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="modal-multi-call-result" class="multi-call-result-display">
                    <!-- 多人点名结果将显示在这里 -->
                </div>
                <div class="modal-actions">
                    <button id="modal-multi-call-close-btn" class="btn btn-primary">
                        <i class="fas fa-check mr-2"></i>
                        确定
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 范围选择结果模态框 -->
    <div id="range-selection-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-arrows-alt-h mr-2"></i>
                    范围选择结果
                </h3>
                <button class="modal-close-btn" id="close-range-selection-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="modal-range-selection-result" class="range-selection-result-display">
                    <!-- 范围选择结果将显示在这里 -->
                </div>
                <div class="modal-actions">
                    <button id="modal-range-selection-confirm-btn" class="btn btn-primary">
                        <i class="fas fa-check mr-2"></i>
                        确定
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 单人快速评分模态框 -->
    <div id="scoring-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container scoring-modal-container">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-star mr-2"></i>
                    快速评分
                </h3>
                <button class="modal-close-btn" id="close-scoring-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="modal-student-info" class="student-info-card">
                    <div class="text-center">
                        <div class="text-lg font-semibold" id="modal-student-name">学生姓名</div>
                        <div class="text-sm opacity-90" id="modal-student-id">座号</div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="block text-gray-700 text-sm font-bold mb-2">答题表现:</label>
                    <div class="quick-scoring-buttons">
                        <button id="modal-correct-answer-btn" class="btn btn-success performance-btn">
                            <i class="fas fa-check mr-2"></i>回答正确
                        </button>
                        <button id="modal-incorrect-answer-btn" class="btn btn-danger performance-btn">
                            <i class="fas fa-times mr-2"></i>回答错误
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="modal-quick-points" class="block text-gray-700 text-sm font-bold mb-2">加分值:</label>
                    <select id="modal-quick-points" class="quick-points-select">
                        <option value="1">1分 (优秀)</option>
                        <option value="0.5" selected>0.5分 (良好)</option>
                        <option value="0">0分 (错误)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="modal-quick-reason" class="block text-gray-700 text-sm font-bold mb-2">评分原因:</label>
                    <select id="modal-quick-reason-select" class="quick-reason-input mb-2">
                        <option value="">请选择评价类型</option>
                        <optgroup label="答题表现">
                            <option value="回答问题正确">回答问题正确</option>
                            <option value="思路清晰，表达准确">思路清晰，表达准确</option>
                            <option value="解题方法新颖">解题方法新颖</option>
                            <option value="答案完整详细">答案完整详细</option>
                        </optgroup>
                        <optgroup label="课堂参与">
                            <option value="积极参与讨论">积极参与讨论</option>
                            <option value="主动举手发言">主动举手发言</option>
                            <option value="课堂提问积极">课堂提问积极</option>
                            <option value="小组合作表现好">小组合作表现好</option>
                        </optgroup>
                        <optgroup label="学习态度">
                            <option value="学习态度认真">学习态度认真</option>
                            <option value="课堂专注度高">课堂专注度高</option>
                            <option value="作业完成质量高">作业完成质量高</option>
                            <option value="预习复习到位">预习复习到位</option>
                        </optgroup>
                        <optgroup label="互助行为">
                            <option value="帮助同学解答问题">帮助同学解答问题</option>
                            <option value="主动分享学习心得">主动分享学习心得</option>
                            <option value="协助老师维持秩序">协助老师维持秩序</option>
                            <option value="带动班级学习氛围">带动班级学习氛围</option>
                        </optgroup>
                        <optgroup label="创新表现">
                            <option value="创新思维，见解独到">创新思维，见解独到</option>
                            <option value="提出有价值的问题">提出有价值的问题</option>
                            <option value="展示独特的解题思路">展示独特的解题思路</option>
                            <option value="课堂表现优秀">课堂表现优秀</option>
                        </optgroup>
                        <option value="custom">自定义评价</option>
                    </select>
                    <input type="text" id="modal-quick-reason" class="quick-reason-input" placeholder="自定义评价内容" style="display: none;">
                </div>
                <div class="modal-actions">
                    <button id="modal-confirm-scoring-btn" class="btn btn-primary">
                        <i class="fas fa-award mr-2"></i>确认评分
                    </button>
                    <button id="modal-skip-scoring-btn" class="btn btn-secondary">
                        <i class="fas fa-forward mr-2"></i>跳过
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 小组快速评分模态框 -->
    <div id="group-scoring-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container group-scoring-modal-container">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-users mr-2"></i>
                    小组快速评分
                </h3>
                <button class="modal-close-btn" id="close-group-scoring-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="modal-group-info" class="group-info-card">
                    <div class="text-center">
                        <div class="text-lg font-semibold" id="modal-group-students">小组学生</div>
                        <div class="text-sm opacity-90" id="modal-group-count">人数</div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="block text-gray-700 text-sm font-bold mb-2">小组表现:</label>
                    <div class="quick-scoring-buttons">
                        <button id="modal-group-correct-btn" class="btn btn-success performance-btn">
                            <i class="fas fa-check mr-2"></i>表现优秀
                        </button>
                        <button id="modal-group-partial-btn" class="btn btn-warning performance-btn">
                            <i class="fas fa-minus mr-2"></i>表现一般
                        </button>
                        <button id="modal-group-poor-btn" class="btn btn-danger performance-btn">
                            <i class="fas fa-times mr-2"></i>表现不佳
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="modal-group-quick-points" class="block text-gray-700 text-sm font-bold mb-2">加分值:</label>
                    <select id="modal-group-quick-points" class="quick-points-select">
                        <option value="1">1分 (优秀)</option>
                        <option value="0.5" selected>0.5分 (良好)</option>
                        <option value="0">0分 (不佳)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="modal-group-quick-reason" class="block text-gray-700 text-sm font-bold mb-2">评分原因:</label>
                    <select id="modal-group-quick-reason-select" class="quick-reason-input mb-2">
                        <option value="">请选择评价类型</option>
                        <optgroup label="集体合作表现">
                            <option value="集体讨论积极热烈">集体讨论积极热烈</option>
                            <option value="团队协作配合默契">团队协作配合默契</option>
                            <option value="集体分工明确合理">集体分工明确合理</option>
                            <option value="集体完成学习任务">集体完成学习任务</option>
                            <option value="集体组织能力强">集体组织能力强</option>
                        </optgroup>
                        <optgroup label="集体学习表现">
                            <option value="集体展示表现优秀">集体展示表现优秀</option>
                            <option value="集体创新思维突出">集体创新思维突出</option>
                            <option value="集体学习氛围浓厚">集体学习氛围浓厚</option>
                            <option value="集体作业完成质量高">集体作业完成质量高</option>
                            <option value="集体课堂参与度高">集体课堂参与度高</option>
                        </optgroup>
                        <optgroup label="集体互助行为">
                            <option value="集体内互相帮助">集体内互相帮助</option>
                            <option value="集体共同进步明显">集体共同进步明显</option>
                            <option value="集体带动班级氛围">集体带动班级氛围</option>
                            <option value="集体协助老师管理">集体协助老师管理</option>
                            <option value="集体分享学习心得">集体分享学习心得</option>
                        </optgroup>
                        <optgroup label="集体创新表现">
                            <option value="集体提出创新方案">集体提出创新方案</option>
                            <option value="集体展示独特思路">集体展示独特思路</option>
                            <option value="集体解决复杂问题">集体解决复杂问题</option>
                            <option value="集体贡献有价值观点">集体贡献有价值观点</option>
                        </optgroup>
                        <optgroup label="集体纪律表现">
                            <option value="集体遵守课堂纪律">集体遵守课堂纪律</option>
                            <option value="集体维护课堂秩序">集体维护课堂秩序</option>
                            <option value="集体按时完成任务">集体按时完成任务</option>
                            <option value="集体态度认真负责">集体态度认真负责</option>
                        </optgroup>
                        <optgroup label="集体荣誉表现">
                            <option value="集体获得比赛奖项">集体获得比赛奖项</option>
                            <option value="集体代表班级荣誉">集体代表班级荣誉</option>
                            <option value="集体为班级争光">集体为班级争光</option>
                            <option value="集体表现突出优秀">集体表现突出优秀</option>
                        </optgroup>
                        <option value="custom">自定义评价</option>
                    </select>
                    <input type="text" id="modal-group-quick-reason" class="quick-reason-input" placeholder="自定义评价内容" style="display: none;">
                </div>
                <div class="modal-actions">
                    <button id="modal-confirm-group-scoring-btn" class="btn btn-primary">
                        <i class="fas fa-award mr-2"></i>确认评分
                    </button>
                    <button id="modal-skip-group-scoring-btn" class="btn btn-secondary">
                        <i class="fas fa-forward mr-2"></i>跳过
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 新个人加分模态框 -->
    <div id="new-individual-scoring-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container scoring-modal-container">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-user mr-2"></i>
                    个人加分
                </h3>
                <button class="modal-close-btn" id="close-new-individual-scoring-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="new-modal-student-info" class="student-info-card">
                    <div class="text-center">
                        <div class="text-lg font-semibold" id="new-modal-student-name">学生姓名</div>
                        <div class="text-sm opacity-90" id="new-modal-student-id">座号</div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="new-modal-individual-points" class="block text-gray-700 text-sm font-bold mb-2">加分值:</label>
                    <input type="number" id="new-modal-individual-points" class="modern-input" value="0.5" step="0.5" min="0.5">
                </div>
                <div class="form-group">
                    <label for="new-modal-individual-reason" class="block text-gray-700 text-sm font-bold mb-2">评分原因:</label>
                    <select id="new-modal-individual-reason-select" class="modern-input mb-2">
                        <option value="">请选择评价类型</option>
                        <optgroup label="答题表现">
                            <option value="回答问题正确">回答问题正确</option>
                            <option value="思路清晰，表达准确">思路清晰，表达准确</option>
                            <option value="解题方法新颖">解题方法新颖</option>
                            <option value="答案完整详细">答案完整详细</option>
                        </optgroup>
                        <optgroup label="课堂参与">
                            <option value="积极参与讨论">积极参与讨论</option>
                            <option value="主动举手发言">主动举手发言</option>
                            <option value="课堂提问积极">课堂提问积极</option>
                            <option value="小组合作表现好">小组合作表现好</option>
                        </optgroup>
                        <optgroup label="学习态度">
                            <option value="学习态度认真">学习态度认真</option>
                            <option value="课堂专注度高">课堂专注度高</option>
                            <option value="作业完成质量高">作业完成质量高</option>
                            <option value="预习复习到位">预习复习到位</option>
                        </optgroup>
                        <optgroup label="互助行为">
                            <option value="帮助同学解答问题">帮助同学解答问题</option>
                            <option value="主动分享学习心得">主动分享学习心得</option>
                            <option value="协助老师维持秩序">协助老师维持秩序</option>
                            <option value="带动班级学习氛围">带动班级学习氛围</option>
                        </optgroup>
                        <optgroup label="创新表现">
                            <option value="创新思维，见解独到">创新思维，见解独到</option>
                            <option value="提出有价值的问题">提出有价值的问题</option>
                            <option value="展示独特的解题思路">展示独特的解题思路</option>
                            <option value="课堂表现优秀">课堂表现优秀</option>
                        </optgroup>
                        <option value="custom">自定义评价</option>
                    </select>
                    <input type="text" id="new-modal-individual-reason" class="modern-input" placeholder="自定义评价内容" style="display: none;">
                </div>
                <div class="modal-actions">
                    <button id="new-modal-confirm-individual-scoring-btn" class="btn btn-primary">
                        <i class="fas fa-award mr-2"></i>确认加分
                    </button>
                    <button id="new-modal-cancel-individual-scoring-btn" class="btn btn-secondary">
                        <i class="fas fa-times mr-2"></i>取消
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 新集体加分模态框 -->
    <div id="new-group-scoring-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container group-scoring-modal-container">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-users mr-2"></i>
                    集体加分
                </h3>
                <button class="modal-close-btn" id="close-new-group-scoring-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="bg-blue-50 border-l-4 border-blue-400 p-3 mb-4">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <i class="fas fa-info-circle text-blue-400"></i>
                    </div>
                    <div class="ml-3">
                        <p class="text-sm text-blue-700">
                            <strong>集体加分说明：</strong>为选中的学生集体加分，所有学生将获得相同的分数。适用于小组合作、集体活动、团队表现等场景。
                        </p>
                    </div>
                </div>
            </div>
            <div class="modal-body">
                <div id="new-modal-group-info" class="group-info-card">
                    <div class="text-center">
                        <div class="text-lg font-semibold" id="new-modal-group-students">选中的学生</div>
                        <div class="text-sm opacity-90" id="new-modal-group-count">人数</div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="new-modal-group-points" class="block text-gray-700 text-sm font-bold mb-2">加分值:</label>
                    <div class="flex gap-2 mb-2">
                        <button type="button" class="btn btn-outline btn-sm" onclick="document.getElementById('new-modal-group-points').value='0.5'">0.5分</button>
                        <button type="button" class="btn btn-outline btn-sm" onclick="document.getElementById('new-modal-group-points').value='1'">1分</button>
                        <button type="button" class="btn btn-outline btn-sm" onclick="document.getElementById('new-modal-group-points').value='1.5'">1.5分</button>
                        <button type="button" class="btn btn-outline btn-sm" onclick="document.getElementById('new-modal-group-points').value='2'">2分</button>
                    </div>
                    <input type="number" id="new-modal-group-points" class="modern-input" value="0.5" step="0.5" min="0.5" max="5">
                    <div class="text-xs text-gray-500 mt-1">建议：集体表现优秀可给予0.5-2分，特别突出可给予更高分数</div>
                </div>
                <div class="form-group">
                    <label for="new-modal-group-reason" class="block text-gray-700 text-sm font-bold mb-2">评分原因:</label>
                    <div class="text-xs text-gray-500 mb-2">请根据集体的具体表现选择最合适的评价类型</div>
                    <select id="new-modal-group-reason-select" class="modern-input mb-2">
                        <option value="">请选择评价类型</option>
                        <optgroup label="集体合作表现">
                            <option value="集体讨论积极热烈">集体讨论积极热烈</option>
                            <option value="团队协作配合默契">团队协作配合默契</option>
                            <option value="集体分工明确合理">集体分工明确合理</option>
                            <option value="集体完成学习任务">集体完成学习任务</option>
                            <option value="集体组织能力强">集体组织能力强</option>
                        </optgroup>
                        <optgroup label="集体学习表现">
                            <option value="集体展示表现优秀">集体展示表现优秀</option>
                            <option value="集体创新思维突出">集体创新思维突出</option>
                            <option value="集体学习氛围浓厚">集体学习氛围浓厚</option>
                            <option value="集体作业完成质量高">集体作业完成质量高</option>
                            <option value="集体课堂参与度高">集体课堂参与度高</option>
                        </optgroup>
                        <optgroup label="集体互助行为">
                            <option value="集体内互相帮助">集体内互相帮助</option>
                            <option value="集体共同进步明显">集体共同进步明显</option>
                            <option value="集体带动班级氛围">集体带动班级氛围</option>
                            <option value="集体协助老师管理">集体协助老师管理</option>
                            <option value="集体分享学习心得">集体分享学习心得</option>
                        </optgroup>
                        <optgroup label="集体创新表现">
                            <option value="集体提出创新方案">集体提出创新方案</option>
                            <option value="集体展示独特思路">集体展示独特思路</option>
                            <option value="集体解决复杂问题">集体解决复杂问题</option>
                            <option value="集体贡献有价值观点">集体贡献有价值观点</option>
                        </optgroup>
                        <optgroup label="集体纪律表现">
                            <option value="集体遵守课堂纪律">集体遵守课堂纪律</option>
                            <option value="集体维护课堂秩序">集体维护课堂秩序</option>
                            <option value="集体按时完成任务">集体按时完成任务</option>
                            <option value="集体态度认真负责">集体态度认真负责</option>
                        </optgroup>
                        <optgroup label="集体荣誉表现">
                            <option value="集体获得比赛奖项">集体获得比赛奖项</option>
                            <option value="集体代表班级荣誉">集体代表班级荣誉</option>
                            <option value="集体为班级争光">集体为班级争光</option>
                            <option value="集体表现突出优秀">集体表现突出优秀</option>
                        </optgroup>
                        <option value="custom">自定义评价</option>
                    </select>
                    <input type="text" id="new-modal-group-reason" class="modern-input" placeholder="自定义评价内容" style="display: none;">
                </div>
                <div class="modal-actions">
                    <button id="new-modal-confirm-group-scoring-btn" class="btn btn-primary">
                        <i class="fas fa-award mr-2"></i>确认加分
                    </button>
                    <button id="new-modal-cancel-group-scoring-btn" class="btn btn-secondary">
                        <i class="fas fa-times mr-2"></i>取消
                    </button>
                </div>
                <div class="mt-4 p-3 bg-gray-50 rounded-lg">
                    <div class="text-xs text-gray-600">
                        <i class="fas fa-lightbulb mr-1"></i>
                        <strong>提示：</strong>集体加分将同时为所有选中的学生添加相同分数，适用于小组合作、集体活动、团队竞赛等场景。
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 核心模块 -->
    <script src="js/core/classroom.js"></script>
    <script src="js/core/students.js"></script>
    <script src="js/core/points.js"></script>
    
    <!-- AI分析模块依赖 -->
    <script src="js/features/ai-analysis/FileUploadManager.js"></script>
    <script src="js/features/ai-analysis/APIConfigManager.js"></script>
    <script src="js/features/ai-analysis/DataProcessor.js"></script>
    <script src="js/features/ai-analysis/prompts.js"></script>
    <script src="js/features/ai-analysis/PromptManager.js"></script>
    <script src="js/features/ai-analysis/StudentEvaluationParser.js"></script>
    <script src="js/features/ai-analysis/HTMLRenderer.js"></script>
    <script src="js/features/ai-analysis/AIAnalyzer.js"></script>
    <script src="js/features/ai-analysis/ReportGenerator.js"></script>
    <script src="js/features/ai-analysis/ExportManager.js"></script>
    
    <!-- 功能模块 -->
    <script src="js/features/layout-manager.js"></script>
    <script src="js/features/rollcall.js"></script>
    <script src="js/features/scoring.js"></script>
    <script src="js/features/ai-analysis.js"></script>
    
    <!-- 工具模块 -->
    <script src="js/utils/storage.js"></script>
    <script src="js/utils/helpers.js"></script>
    <script src="js/utils/component-loader.js"></script>
    <script src="js/utils/NotificationManager.js"></script>
    
    <!-- 主入口文件 -->
    <script src="js/main.js"></script>
</body>
</html>